"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var AnyEvent=_interopDefault(require("any-event")),extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function __extends(t,e){function n(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var __assign=function(){return(__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function __rest(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n}function __values(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function __read(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function __spread(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t}var IS_WX=void 0===window,SUPPORT_TOUCH=IS_WX||"ontouchstart"in window,COMPUTE_INTERVAL=16,CLIENT_X="clientX",CLIENT_Y="clientY",INPUT_START="start",INPUT_MOVE="move",INPUT_CANCEL="cancel",INPUT_END="end",NONE="none",getVLength=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},getDotProduct=function(t,e){return t.x*e.x+t.y*e.y},getRadian=function(t,e){var n=getVLength(t)*getVLength(e);if(0===n)return 0;var i=getDotProduct(t,e)/n;return i>1&&(i=1),Math.acos(i)},getCross=function(t,e){return t.x*e.y-e.x*t.y},getAngle=function(t,e){var n=getRadian(t,e);return getCross(t,e)>0&&(n*=-1),radianToAngle(n)},radianToAngle=function(t){return t/Math.PI*180},angleToRadian=function(t){return t/180*Math.PI},getCenter=function(t){var e=t.length,n=t.reduce(function(t,e){return t.x+=e[CLIENT_X],t.y+=e[CLIENT_Y],t},{x:0,y:0});return{x:Math.round(n.x/e),y:Math.round(n.y/e)}},getDirection=function(t,e){return t===e?"none":Math.abs(t)>Math.abs(e)?0<t?"right":"left":0<e?"down":"up"},Vector=Object.freeze({getVLength:getVLength,getDotProduct:getDotProduct,getRadian:getRadian,getCross:getCross,getAngle:getAngle,radianToAngle:radianToAngle,angleToRadian:angleToRadian,getCenter:getCenter,getDirection:getDirection}),default_1=function(){},default_1$1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.load=function(t){var e=Array.from(t.touches).map(function(t){return{clientX:t.clientX,clientY:t.clientY}}),n=Array.from(t.changedTouches).map(function(t){return{clientX:t.clientX,clientY:t.clientY}});return{eventType:t.type.replace("touch",""),changedPoints:n,points:e,nativeEvent:t}},e}(default_1),default_1$2=function(t){function e(){var e=t.call(this)||this;return e.isPressed=!1,e}return __extends(e,t),e.prototype.load=function(t){var e=t.clientX,n=t.clientY,i=t.type,o=t.button,r=this.prevPoints||[{clientX:e,clientY:n}],s=[{clientX:e,clientY:n}];if(this.prevPoints=[{clientX:e,clientY:n}],"mousedown"===i){if(0!==o)return;this.isPressed=!0}if("mousemove"===i){if(!this.isPressed)return}else if("mouseup"===i){if(!this.isPressed)return;s=[],this.isPressed=!1}return{eventType:{mousedown:"start",mousemove:"move",mouseup:"end"}[i],changedPoints:r,points:s,nativeEvent:t}},e}(default_1),default_1$3=function(){function t(){this.adapter=SUPPORT_TOUCH?new default_1$1:new default_1$2}return t.prototype.load=function(t){var e=this.adapter.load(t);if(void 0!==e){var n=e.eventType,i=e.points,o=e.changedPoints,r=i.length,s=o.length,a=INPUT_START===n,u=INPUT_END===n||INPUT_CANCEL===n;0<r&&(this._center=getCenter(e.points));var c=Date.now(),p=t.target,l=t.currentTarget,h=this._center||{},d=h.x,f=h.y;return __assign({},e,{preventDefault:function(){t.preventDefault()},isStart:a,isEnd:u,pointLength:r,changedPointLength:s,center:this._center,x:d,y:f,timestamp:c,target:p,currentTarget:l,nativeEvent:t})}},t}(),intervalCompute=function(t,e){var n=t.prevInput,i=t.input,o=0,r=0,s=0,a=0,u="none";if(void 0!==i){var c=n||i,p=i.timestamp-c.timestamp;if(-1===[INPUT_CANCEL,INPUT_END].indexOf(i.eventType)&&(COMPUTE_INTERVAL<p||void 0===e.get("direction"))){var l=i.x-c.x,h=i.y-c.y;s=Math.round(l/p*100)/100,a=Math.round(h/p*100)/100,o=Math.abs(s),r=Math.abs(a),u=getDirection(l,h)||e.get("direction"),e.set({speedX:s}),e.set({speedY:a}),e.set({velocityX:o}),e.set({velocityY:r}),e.set({direction:u})}else s=e.get("speedX",0),a=e.get("speedY",0),o=e.get("velocityX",0),r=e.get("velocityY",0),u=e.get("direction")}return{velocityX:o,velocityY:r,speedX:s,speedY:a,direction:u}};function computeDistance(t,e){var n=t.startInput,i=t.input,o=i.eventType,r=0,s=0;"start"===o?(e.set({displacementX:r}),e.set({displacementY:s})):"move"===o?(r=Math.round(i.points[0][CLIENT_X]-n.points[0][CLIENT_X]),s=Math.round(i.points[0][CLIENT_Y]-n.points[0][CLIENT_Y]),e.set({displacementX:r}),e.set({displacementY:s})):"end"===o&&(r=e.get("displacementX",0),s=e.get("displacementY",0));var a=Math.abs(r),u=Math.abs(s);return{displacementX:r,displacementY:s,distanceX:a,distanceY:u,distance:Math.round(getVLength({x:a,y:u})),overallDirection:getDirection(r,s)}}function computeDeltaXY(t,e){var n,i,o=t.prevInput,r=t.input,s=0;if(void 0===o?(n=0,i=0):(n=r.x-o.x,i=r.y-o.y),0!==n||0!==i){var a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));s=Math.round(radianToAngle(Math.acos(Math.abs(n)/a))),e.set({deltaXYAngle:s})}else s=e.get("deltaXYAngle",0);return{deltaX:n,deltaY:i,deltaXYAngle:s}}var computeMaxLength=function(t,e){var n=t.pointLength;return t.isStart?(n>e.get("maxPointLength",0)&&e.set({maxPointLength:n}),n):e.get("maxPointLength",0)},computeVector=function(t){return{x:t.points[1][CLIENT_X]-t.points[0][CLIENT_X],y:t.points[1][CLIENT_Y]-t.points[0][CLIENT_Y]}};function computeScale(t){var e=t.startV,n=t.prevV,i=t.activeV,o=getVLength(i)/getVLength(n);return{scale:getVLength(i)/getVLength(e),deltaScale:o}}function computeAngle(t){var e=t.startV,n=t.prevV,i=t.activeV,o=getAngle(i,n);return{angle:getAngle(i,e),deltaAngle:o}}function computMulti(t,e){var n=t.startMultiInput,i=t.prevInput,o=t.input;if(void 0!==i&&1<i.points.length&&1<o.points.length){var r=computeVector(n),s=computeVector(i),a=computeVector(o),u=computeScale({startV:r,activeV:a,prevV:s}),c=u.scale,p=u.deltaScale,l=computeAngle({startV:r,prevV:s,activeV:a}),h=l.deltaAngle,d=l.angle;return e.set({angle:d}),e.set({scale:c}),{scale:c,deltaScale:p,deltaAngle:h,angle:d}}return{scale:e.get("scale",1),deltaScale:1,deltaAngle:0,angle:e.get("angle",0)}}function compute(t,e){var n=t.input,i=computeDistance(t,e),o=i.displacementX,r=i.displacementY,s=i.distanceX,a=i.distanceY,u=i.distance,c=i.overallDirection,p=t.input.timestamp-t.startInput.timestamp,l=intervalCompute(t,e),h=l.velocityX,d=l.velocityY,f=l.speedX,v=l.speedY,T=l.direction,g=computeDeltaXY(t,e),_=g.deltaX,y=g.deltaY,m=g.deltaXYAngle,E=computMulti(t,e),S=E.scale,A=E.deltaScale,P=E.angle,N=E.deltaAngle,I=computeMaxLength(n,e);return __assign({type:""},n,{velocityX:h,velocityY:d,speedX:f,speedY:v,deltaTime:p,overallDirection:c,direction:T,deltaX:_,deltaY:y,deltaXYAngle:m,displacementX:o,displacementY:r,distanceX:s,distanceY:a,distance:u,scale:S,deltaScale:A,angle:P,deltaAngle:N,maxPointLength:I})}var default_1$4=function(){function t(t){var e=t.$store;this.inputFactory=new default_1$3,this.$store=e}return t.prototype.load=function(t){var e=this.inputFactory.load(t);if(void 0!==e)return compute(this._record(e),this.$store)},t.prototype._record=function(t){var e=t.eventType;return this.prevInput=this.activeInput,"start"===e&&(t.isStart&&(this.startInput=t),1<t.pointLength?this.startMultiInput=t:this.startMultiInput=void 0),this.activeInput=t,{startMultiInput:this.startMultiInput,startInput:this.startInput,prevInput:this.prevInput,input:t}},t}(),computeTouchAction=function(t){var e,n,i={auto:0,manipulation:1,"pan-x":2,"pan-y":2,none:3},o=i.none,r=["auto"],s=0;try{for(var a=__values(t),u=a.next();!u.done;u=a.next()){var c=u.value,p=i[c];if(o===p){r=[c];break}s<p?(r=[c],s=p):s===p&&0<p&&(r.push(c),s=p)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return r.join(" ")},default_1$5=function(){function t(){this.store={}}return t.prototype.set=function(t){this.store=__assign({},this.store,t)},t.prototype.get=function(t,e){return this.store[t]||e},t.prototype.reset=function(){this.store={}},t.prototype.destroy=function(){this.reset()},t}(),STATUS_POSSIBLE="possible",STATUS_START="start",STATUS_MOVE="move",STATUS_END="end",STATUS_CANCELLED="cancel",STATUS_FAILED="failed",STATUS_RECOGNIZED="recognized",Recognizer=function(){function t(t){this.options=__assign({},this.constructor.DEFAULT_OPTIONS,{disabled:!1},t),this.name=this.options.name,this.disabled=this.options.disabled,this.status=STATUS_POSSIBLE,this.isRecognized=!1,this.requireFailureRecognizers=[],this.isWaitingOther=!1}return t.prototype.set=function(t){return void 0===t&&(t={}),this.options=__assign({},this.options,t),this.$root.update(),this},t.prototype.$injectRoot=function(t){return this.$root=t,this},t.prototype.emit=function(t,e){if(e.type=t,this.$root.eventEmitter.emit(t,e),void 0!==this.$root.el&&(this.$root.options.syncToAttr&&this.$root.el.setAttribute("at-gesture",t),this.$root.options.hasDomEvents)){e.target,e.currentTarget;var n=e.type,i=__rest(e,["target","currentTarget","type"]),o=new Event(n,e);Object.assign(o,i),this.$root.el.dispatchEvent(o)}},t.prototype.requireFailure=function(t){this.requireFailureRecognizers.includes(t)||this.requireFailureRecognizers.push(t)},t.prototype.removeRequireFailure=function(t){var e,n;try{for(var i=__values(this.requireFailureRecognizers.entries()),o=i.next();!o.done;o=i.next()){var r=__read(o.value,2),s=r[0];if(r[1].name===t.name){this.requireFailureRecognizers.splice(s,1);break}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.hasRequireFailure=function(){return 0<this.requireFailureRecognizers.length},t.prototype.isAllRequireFailureRecognizersDisabled=function(){return this.requireFailureRecognizers.every(function(t){return t.disabled})},t.prototype.isAllRequiresFailedOrPossible=function(){var t,e;try{for(var n=__values(this.requireFailureRecognizers),i=n.next();!i.done;i=n.next()){var o=i.value;if(o.isWaitingOther)return!1;if(STATUS_FAILED!==o.status&&STATUS_POSSIBLE!==o.status)return!1}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return!0},t.prototype.isValidPointLength=function(t){return 0===this.options.pointLength||this.options.pointLength===t},t.prototype.isOnlyHorizontal=function(){var t,e,n=!0;try{for(var i=__values(this.options.directions),o=i.next();!o.done;o=i.next()){var r=o.value;if(!(n=-1<["left","right"].indexOf(r)))return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},t.prototype.isOnlyVertical=function(){var t,e,n=!0;try{for(var i=__values(this.options.directions),o=i.next();!o.done;o=i.next()){var r=o.value;if(!(n=-1<["up","down"].indexOf(r)))return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},t.prototype.isVaildDirection=function(t){return-1!==this.options.directions.indexOf(t)||"none"===t},t.prototype.flow=function(t,e,n){var i,o,r,s,a,u,c,p={1:(i={},i[STATUS_POSSIBLE]=(o={},o[INPUT_MOVE]=STATUS_START,o[INPUT_END]=STATUS_RECOGNIZED,o[INPUT_CANCEL]=STATUS_CANCELLED,o),i[STATUS_START]=(r={},r[INPUT_MOVE]=STATUS_MOVE,r[INPUT_END]=STATUS_END,r[INPUT_CANCEL]=STATUS_CANCELLED,r),i[STATUS_MOVE]=(s={},s[INPUT_MOVE]=STATUS_MOVE,s[INPUT_END]=STATUS_END,s),i),0:(a={},a[STATUS_START]=(u={},u[INPUT_MOVE]=STATUS_CANCELLED,u[INPUT_END]=STATUS_END,u[INPUT_CANCEL]=STATUS_CANCELLED,u),a[STATUS_MOVE]=(c={},c[INPUT_MOVE]=STATUS_CANCELLED,c[INPUT_END]=STATUS_END,c[INPUT_CANCEL]=STATUS_CANCELLED,c),a)};return void 0!==p[Number(t)][e]&&p[Number(t)][e][n]||e},t.prototype._resetStatus=function(){-1!==[STATUS_END,STATUS_CANCELLED,STATUS_RECOGNIZED,STATUS_FAILED].indexOf(this.status)&&(this.status=STATUS_POSSIBLE)},t.prototype.recognize=function(t){var e=this.test(t);this._resetStatus();var n=t.eventType;this.status=this.flow(e,this.status,n),STATUS_CANCELLED!==this.status?(this.isRecognized=-1<[STATUS_START,STATUS_MOVE,STATUS_END,STATUS_RECOGNIZED].indexOf(this.status),e?(this.afterRecognized(t),this.emit(this.options.name,t),this.emit(this.options.name+this.status,t),this.afterEmit(t)):this.isRecognized&&this.emit(this.options.name+this.status,t)):this.emit(this.options.name+"cancel",t)},t.prototype.afterRecognized=function(t){},t.prototype.afterEmit=function(t){},t}(),TapRecognizer=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,e)||this;return n.tapCount=0,n}return __extends(e,t),e.prototype.getTouchAction=function(){return 1<this.options.tapTimes?["manipulation"]:["auto"]},e.prototype._isValidDistanceFromPrevTap=function(t){if(void 0!==this.prevTapPoint){var e=getVLength({x:t.x-this.prevTapPoint.x,y:t.y-this.prevTapPoint.y});return this.prevTapPoint=t,this.options.tapsPositionTolerance>=e}return this.prevTapPoint=t,!0},e.prototype._isValidInterval=function(){var t=Date.now();if(void 0===this.prevTapTime)return this.prevTapTime=t,!0;var e=t-this.prevTapTime;return this.prevTapTime=t,e<this.options.waitNextTapTime},e.prototype.recognize=function(t){var e=this;INPUT_END===t.eventType&&(this.status=STATUS_POSSIBLE,this.test(t)?(clearTimeout(this._delayFailTimer),clearTimeout(this._waitOtherFailedTimer),this.isWaitingOther=!1,this._isValidDistanceFromPrevTap(t)&&this._isValidInterval()?this.tapCount++:this.tapCount=1,0==this.tapCount%this.options.tapTimes?this.hasRequireFailure()&&!this.isAllRequireFailureRecognizersDisabled()?(this.isWaitingOther=!0,this._waitOtherFailedTimer=setTimeout(function(){e.isAllRequiresFailedOrPossible()?(e.status=STATUS_RECOGNIZED,e.emit(e.options.name,__assign({},t,{tapCount:e.tapCount}))):e.status=STATUS_FAILED,e.isWaitingOther=!1},this.options.waitNextTapTime)):(this.status=STATUS_RECOGNIZED,this.emit(this.options.name,__assign({},t,{tapCount:this.tapCount})),this.reset()):this._delayFailTimer=setTimeout(function(){e.status=STATUS_FAILED,e.reset()},this.options.waitNextTapTime)):(this.reset(),this.status=STATUS_FAILED))},e.prototype.reset=function(){this.tapCount=0,this.prevTapPoint=void 0,this.prevTapTime=void 0},e.prototype.test=function(t){var e=t.distance,n=t.deltaTime;return t.maxPointLength===this.options.pointLength&&this.options.positionTolerance>=e&&this.options.maxPressTime>n},e.prototype.afterEmit=function(t){},e.DEFAULT_OPTIONS={name:"tap",pointLength:1,tapTimes:1,waitNextTapTime:300,disabled:!1,positionTolerance:2,tapsPositionTolerance:9,maxPressTime:250},e}(Recognizer),PressRecognizer=function(t){function e(e){return void 0===e&&(e={}),t.call(this,e)||this}return __extends(e,t),e.prototype.getTouchAction=function(){return["auto"]},e.prototype.recognize=function(t){var e=this,n=t.eventType,i=t.deltaTime;INPUT_START===n&&this.test(t)?(this._resetStatus(),this.cancel(),this._timeoutId=setTimeout(function(){e.status=STATUS_RECOGNIZED,e.emit(e.options.name,t)},this.options.minPressTime)):INPUT_END===n&&STATUS_RECOGNIZED===this.status?this.emit(this.options.name+"up",t):(!this.test(t)||this.options.minPressTime>i&&-1!==[INPUT_END,INPUT_CANCEL].indexOf(n))&&(this.cancel(),this.status=STATUS_FAILED)},e.prototype.test=function(t){var e=t.distance,n=t.pointLength;return this.options.positionTolerance>e&&this.isValidPointLength(n)},e.prototype.cancel=function(){clearTimeout(this._timeoutId)},e.prototype.afterEmit=function(){},e.DEFAULT_OPTIONS={name:"press",pointLength:1,positionTolerance:9,minPressTime:251},e}(Recognizer),getHV=function(t){var e,n,i=!1,o=!1;try{for(var r=__values(t),s=r.next();!s.done;s=r.next()){var a=s.value;if(-1<["left","right"].indexOf(a)){if(i=!0,o)break}else{if(!(-1<["up","down"].indexOf(a)))throw new Error("wrong direction!");if(o=!0,i)break}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{hasHorizontal:i,hasVertical:o}},PanRecognizer=function(t){function e(e){return void 0===e&&(e={}),t.call(this,e)||this}return __extends(e,t),e.prototype.getTouchAction=function(){var t=["auto"],e=getHV(this.options.directions),n=e.hasHorizontal,i=e.hasVertical;return n&&i?t=["none"]:!n&&i?t=["pan-x"]:!i&&n&&(t=["pan-y"]),t},e.prototype.test=function(t){var e=t.distance,n=t.direction,i=t.eventType,o=t.pointLength;return INPUT_MOVE===i&&(this.isRecognized||this.options.threshold<e)&&this.isValidPointLength(o)&&this.isVaildDirection(n)},e.prototype.afterEmit=function(t){"none"!==t.direction&&this.emit(this.options.name+t.direction,t)},e.prototype.afterRecognized=function(t){this.lockDirection(t)},e.prototype.lockDirection=function(t){if(void 0===this.options.directions||0===this.options.directions.length)return t;var e=0,n=0;return this.options.directions.forEach(function(i){"left"===i&&0>t.deltaX?e=t.deltaX:"right"===i&&0<t.deltaX?e=t.deltaX:"down"===i&&0<t.deltaY?n=t.deltaY:"up"===i&&0>t.deltaY&&(n=t.deltaY)}),t.deltaX=e,t.deltaY=n,t},e.DEFAULT_OPTIONS={name:"pan",threshold:10,pointLength:1,directions:["up","right","down","left"]},e}(Recognizer),SwipeRecognizer=function(t){function e(e){return void 0===e&&(e={}),t.call(this,e)||this}return __extends(e,t),e.prototype.getTouchAction=function(){return["none"]},e.prototype.afterEmit=function(t){"none"!==t.direction&&this.emit(this.options.name+t.direction,t)},e.prototype.test=function(t){if(INPUT_END!==t.eventType)return!1;var e=t.direction,n=t.velocityX,i=t.velocityY,o=t.maxPointLength,r=t.distance,s=n,a=i;this.isOnlyHorizontal()?a=0:this.isOnlyVertical()&&(s=0);var u=Math.sqrt(s*s+a*a);return 1===o&&this.options.threshold<r&&this.isVaildDirection(e)&&this.options.velocity<u},e.DEFAULT_OPTIONS={name:"swipe",threshold:10,velocity:.3,pointLength:1,directions:["up","right","down","left"]},e}(Recognizer),PinchRecognizer=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,e)||this;return n._prevScale=1,n}return __extends(e,t),e.prototype.getTouchAction=function(){return["none"]},e.prototype.afterEmit=function(t){if("end"!==t.eventType){var e=t.scale;if(1!==e){var n=e>this._prevScale?"out":"in";this.emit(this.options.name+n,t)}this._prevScale=e}},e.prototype.test=function(t){var e=t.pointLength,n=t.scale;return this.isValidPointLength(e)&&(this.options.threshold<Math.abs(n-1)||this.isRecognized)},e.DEFAULT_OPTIONS={name:"pinch",threshold:0,pointLength:2},e}(Recognizer),RotateRecognizer=function(t){function e(e){return void 0===e&&(e={}),t.call(this,e)||this}return __extends(e,t),e.prototype.getTouchAction=function(){return["none"]},e.prototype.afterEmit=function(t){},e.prototype.test=function(t){var e=t.pointLength,n=t.angle;return this.isValidPointLength(e)&&(this.options.threshold<Math.abs(n)||this.isRecognized)},e.DEFAULT_OPTIONS={name:"rotate",threshold:0,pointLength:2},e}(Recognizer),AnyTouch=function(){function t(t,e){this.default={touchAction:"compute",hasDomEvents:!0,isPreventDefault:!0,syncToAttr:!1,cssPrevent:{selectText:!0,drag:!0,tapHighlight:!0,callout:!0}},void 0!==t&&(this.el=t),this.$store=new default_1$5,this.inputManage=new default_1$4({$store:this.$store}),this.touchDevice=SUPPORT_TOUCH?"touch":"mouse",this.options=__assign({},this.default,e),this.eventEmitter=new AnyEvent,this._isStopped=!1,this.recognizers=[(new RotateRecognizer).$injectRoot(this),(new PinchRecognizer).$injectRoot(this),(new PanRecognizer).$injectRoot(this),(new SwipeRecognizer).$injectRoot(this),(new TapRecognizer).$injectRoot(this),new TapRecognizer({name:"doubletap",pointLength:1,tapTimes:2,disabled:!0}).$injectRoot(this),(new PressRecognizer).$injectRoot(this)],this.recognizers[4].requireFailure(this.recognizers[5]),void 0!==this.el&&(this.update(),this._unbindEl=this._bindEL(this.el)._unbindEl)}return t.prototype.updateTouchAction=function(){var t,e;if("compute"===this.options.touchAction){var n=[];try{for(var i=__values(this.recognizers),o=i.next();!o.done;o=i.next()){var r=o.value;n.push.apply(n,__spread(r.getTouchAction()))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.el.style.touchAction=computeTouchAction(n)}else this.el.style.touchAction=this.options.touchAction||"auto"},t.prototype.updateCssPrevent=function(){var t={},e=this.options.cssPrevent;if(void 0!==e)for(var n in e.selectText&&(t.mozUserSelect=NONE,t.userSelect=NONE,t.msUserSelect=NONE,t.webkitUserSelect=NONE,t.msTouchSelect=NONE),e.drag&&(t.webkitUserDrag=NONE),e.tapHighlight&&(t.webkitTapHighlightColor="rgba(0,0,0,0)"),e.callout&&(t.webkitTouchCallout=NONE),t)this.el.style[n]=t[n]},t.prototype.update=function(){void 0!==this.el&&(this.updateTouchAction(),this.updateCssPrevent())},t.prototype._bindEL=function(t){var e=this.inputListener.bind(this);if("touch"===this.touchDevice){var n=["touchstart","touchmove","touchend","touchcancel"];return n.forEach(function(n){t.addEventListener(n,e)}),{_unbindEl:function(){n.forEach(function(n){t.removeEventListener(n,e)})}}}return t.addEventListener("mousedown",e),window.addEventListener("mousemove",e),window.addEventListener("mouseup",e),{_unbindEl:function(){t.removeEventListener("mousedown",e),window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",e)}}},t.prototype.useEvent=function(t){this.inputListener(t)},t.prototype.add=function(t){t.$injectRoot(this),this.recognizers.some(function(e){return t.name===e.name})?this.eventEmitter.emit("error",{code:1,message:t.name+"识别器已经存在!"}):(this.recognizers.push(t),this.update())},t.prototype.get=function(t){return this.recognizers.find(function(e){return t===e.options.name})},t.prototype.set=function(t){this.options=__assign({},this.default,t),this.update()},t.prototype.stop=function(){this._isStopped=!0},t.prototype.remove=function(t){var e,n;try{for(var i=__values(this.recognizers.entries()),o=i.next();!o.done;o=i.next()){var r=__read(o.value,2),s=r[0];if(t===r[1].options.name){this.recognizers.splice(s,1);break}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.inputListener=function(t){var e,n;this.options.isPreventDefault&&t.preventDefault();var i=this.inputManage.load(t);if(void 0!==i){this.emit("input",i),i.isStart&&(this._isStopped=!1);try{for(var o=__values(this.recognizers),r=o.next();!r.done;r=o.next()){var s=r.value;if(!s.disabled&&(s.recognize(i),this._isStopped))break}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}}},t.prototype.on=function(t,e,n){void 0===n&&(n=!1),this.eventEmitter.on(t,e)},t.prototype.off=function(t,e){this.eventEmitter.off(t,e)},t.prototype.emit=function(t,e){this.eventEmitter.emit(t,__assign({},e,{type:t}))},t.prototype._unbindEl=function(){},t.prototype.destroy=function(){this.$store.destroy(),this.el&&this._unbindEl(),this.eventEmitter.destroy()},t.Tap=TapRecognizer,t.Press=PressRecognizer,t.Pan=PanRecognizer,t.Swipe=SwipeRecognizer,t.Pinch=PinchRecognizer,t.Rotate=RotateRecognizer,t.version="0.4.6",t.Vector=Vector,t.EventEmitter=AnyEvent,t}(),default_1$6=function(){function t(t){this.stock=[],this.stock=[],this.ClassObject=t}return t.prototype.getIndexByEl=function(t){for(var e=0,n=this.stock.length;e<n;e++)if(t===this.stock[e].el)return e;return-1},t.prototype.getInstanceByIndex=function(t){return this.stock[t].instance},t.prototype.removeInstanceByIndex=function(t){this.stock.splice(t,1)},t.prototype.getOrCreateInstanceByEl=function(t){var e=this.getIndexByEl(t);if(-1===e){var n=new this.ClassObject(t);return this.stock.push({el:t,instance:n}),n}return this.getInstanceByIndex(e)},t}(),iManage=new default_1$6(AnyTouch),plugin={install:function(t){var e=function(t,e){var n=iManage.getOrCreateInstanceByEl(t);void 0!==e.value&&e.value(n)};t.directive("touch",{inserted:function(t,n){e(t,n)},update:function(t,n){e(t,n)},unbind:function(t){!function(t){var e=iManage.getIndexByEl(t);-1!==e&&void 0!==iManage.getInstanceByIndex(e)&&(iManage.getInstanceByIndex(e).destroy(),iManage.removeInstanceByIndex(e))}(t)}})}},default_1$7=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.vTouch=plugin,e}(AnyTouch);module.exports=default_1$7;
//# sourceMappingURL=AnyTouch.common.min.js.map
